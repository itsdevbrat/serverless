# Serverless on AWS 

# Setup AWS CLI (Windows)
The AWS CLI is an open source tool built on top of the AWS SDK for Python that provides commands for interacting with AWS services. Once set up, you can use the CLI to access all the functionality provided on the AWS Management Console to access AWS services and configure resources.

1. Download it. <a href="https://s3.amazonaws.com/aws-cli/AWSCLI64.msi">64 Bit</a> / <a href="https://s3.amazonaws.com/aws-cli/AWSCLI32.msi">32 Bit</a>
2. Install it.
3. Get your AWS **Access Key ID and Secret Access Key** from IAM
4. Run _aws configure_ 

# Setup Serverless Framework


1. Download and Install it _npm install -g serverless_
2. Run _serverless create --template aws-nodejs --path /path/to/project --name functionName_
    If you faced the error **script execution disabled**    
    1. Open Powershell as Run as administrator
    2. Run _Set-ExecutionPolicy RemoteSigned_

You should have the below 3 files autogenerated
.
├── .npmignore
├── handler.js
└── serverless.yml

# Writing code

**1. serverless.yml**

service: getOrders
frameworkVersion: '2'

provider:
  name: aws
  runtime: nodejs12.x
  lambdaHashingVersion: 20201221
  stage: prod
  region: us-east-1
  apiName: GetOrders
  memorySize: 256 # Overwrite the default memory size. Default is 1024
  timeout: 10

functions:
  getOrders:
    handler: index.getOrders
    events:
      - http: /orders
        cors: true
        method: get

2. index.js

'use strict';
const express = require('express')
    , serverless = require('serverless-http')
    , ordersRouter = require('./orders/orders.router');
    
const app = express()
app.use(express.urlencoded({ extended: true }))
app.use(express.json())

app.use('/', ordersRouter);

app.use('*', (req, res) => {
    res.status(404) 
    res.send("Resource not found")
})

const handler = serverless(app);

module.exports.getOrders = async (event, context) => {
 return await handler(event, context);
};

3. Write your routers in the respective folders
